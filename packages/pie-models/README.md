
Typescript types & JSON Schemas for PIE Elments.

This project contains typescript interfaces for models used with PIE components.
It also generates JSON schema documentation for the models. 


## Usage

`npm install`

This will install the typescript lib and also provide the json schemas in `dist/schemas`.


### Typescript

Using the types will provide IDE auto-complete and type-checking on model objects:

`npm install @pie-element/pie-models`

```ts
import {MultipleChoiceConfig} from `@pie-element/pie-models`;

let myConfig:MultipleChoiceConfig = {...};
```

> The types will apply only to the latest versions of PIEs defined in `../packages`
> To validate data for older versions of PIE items use the json schema file in
> the pie package itself under `@pie-elements/packages/pie-name/docs/`



### Generating JSON Schemas and Markdown Docs

The schemas are generated from Typescript types in `src` dir.

`npm run make-schemas`

Will generate JSON schemas and put them in `dist` dir for all directories in the `src/pie` dir that define types.

It will also create markdown files with the `.md` extension with a markdown file describing the properties 
(generated by wetzel)

### Copying JSON Schemas & Markdown to PIE Docs Dirs

`npm run copy-schemas`

This is intended to be run in the context of the `pie-elements` repository. It copies schemas from the `dist/` dir
 in this package to `packages/pie-name/docs` dir by default.

 > Can be run against another directory by passing `-d` option to the script `npx ts-node scripts/GenerateSchemas.ts -c -d some/path`

 This should be run, and the generated schema document committed to the relevant package, every time a schema change 
 is made for a PIE. This provides version-related json schema validation. 

 ### Running Generate Schemas Script Directly

 `scripts/GenerateSchemas.ts` 

`-m` generate shemas
`-c` copy generated schemas
`-p` package dir to run on (defaults to all dirs)
`-d` destination dir for generated files (defaults to `../packages/`)

e.g. the following command will make and copy schema docs for the `select-text` package only
and will output it a non-default directory `dist/docs`

`npx ts-node scripts/GenerateSchemas.ts -m -c -p select-text -d dist/docs`


### View Docs

`npm run view-docs`

Will run a local docson server to view the schema documentation.

## Adding / modifying types

Types should be exported for the PIE in:

`src/pies/pie-name/index.ts`

Where `pie-name`is the same as the directory/package name for the pie in `../packages`.

> the `src/pies` directory should only contain subdirectories that match pies in `pie-elements/packages`


These `index.ts` files should create exports using the package name as pascale case with `Configure` or `Pie` appended. 

e.g. `CategorizeConfigure` `MultipleChoicePie`

`src/index.ts` should be updated with any new types.


## Notes

TODO - enhance markdown support:

wetzel was the cleanest json-schema to markdown generator I could find for now, but it lacks support for some features, 
in particular `examples`. Should fork/modify to add this support at some point.

Other options like https://github.com/adobe/jsonschema2md exist, but not perfect for our needs.


